<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Task Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous" />
    <link rel="stylesheet" href="style.css" />
</head>

<body class="bg-dark text-light">

    <div class="container py-4">
        <header class="mb-5 text-center">
            <h1 class="display-4">Task Manager</h1>
            <p class="text">Add, view, and delete your tasks by priority</p>
        </header>

        <!-- Task Input Section -->
        <section class="mb-4">
            <h2 class="h4 mb-3">Add a Task</h2>
            <div class="input-group">
                <input type="text" id="taskInput" class="form-control" placeholder="Enter task"
                    aria-label="Task name" />
                <select id="prioritySelect" class="form-select" aria-label="Select task priority">
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                </select>
                <button class="btn btn-primary" onclick="addTask()">Add Task</button>
            </div>
        </section>

        <hr />

        <!-- Delete Task Section -->
        <section class="mb-4">
            <h2 class="h4 mb-3">Delete a Task</h2>
            <div class="input-group">
                <input type="text" id="deleteInput" class="form-control" placeholder="Enter task name to delete"
                    aria-label="Task name to delete" />
                <button class="btn btn-danger delete-btn" onclick="deleteTaskBySearch()">Delete Task by Search</button>
            </div>
        </section>

        <hr />

        <!-- Filter Section -->
        <section class="mb-4">
            <label for="filterPriority" class="form-label fw-bold">Filter by Priority</label>
            <select id="filterPriority" class="form-select w-auto" onchange="filterTasks()"
                aria-label="Filter tasks by priority">
                <option value="all">All (Recent)</option>
                <option value="low">Low</option>
                <option value="medium">Medium</option>
                <option value="high">High</option>
            </select>
        </section>

        <!-- Task List -->
        <section>
            <ul id="taskList" class="list-group"></ul>
        </section>
    </div>

    <script>
        // JavaScript goes here (copy the fixed JS from the previous answer)
        let low = [];
        let medium = [];
        let high = [];
        let recent = [];

        function addTask() {
            const taskInput = document.getElementById("taskInput");
            const prioritySelect = document.getElementById("prioritySelect");

            const task = taskInput.value.trim();
            const priority = prioritySelect.value;

            if (!task) return;

            // Add to priority array
            if (priority === "low") low.push(task);
            else if (priority === "medium") medium.push(task);
            else if (priority === "high") high.push(task);

            // Add to recent as object
            recent.unshift({ name: task, priority: priority });

            filterTasks();
            taskInput.value = "";
        }

        function renderTasks(list) {
            const taskList = document.getElementById("taskList");
            taskList.innerHTML = "";

            list.forEach((task) => {
                let taskName = typeof task === "string" ? task : task.name;
                let taskPriority = typeof task === "string" ? document.getElementById("filterPriority").value : task.priority;

                const li = document.createElement("li");
                li.className = `list-group-item d-flex justify-content-between align-items-center ${taskPriority}`;
                li.innerHTML = `
                <span>${taskName}</span>
                <button class="btn btn-sm delete-btn" onclick="deleteTask('${taskName}')">Delete</button>
                `;
                taskList.appendChild(li);
            });
        }

        function filterTasks() {
            const filter = document.getElementById("filterPriority").value;
            if (filter === "all") renderTasks(recent);
            else if (filter === "low") renderTasks(low);
            else if (filter === "medium") renderTasks(medium);
            else if (filter === "high") renderTasks(high);
        }

        function deleteTask(taskName) {
            low = low.filter(task => task !== taskName);
            medium = medium.filter(task => task !== taskName);
            high = high.filter(task => task !== taskName);
            recent = recent.filter(task => task.name !== taskName);

            filterTasks();
        }

        function deleteTaskBySearch() {
            const taskName = document.getElementById("deleteInput").value.trim();
            if (taskName === "") {
                alert("Please enter a task name to delete.");
                return;
            }

            const existsInLow = low.includes(taskName);
            const existsInMedium = medium.includes(taskName);
            const existsInHigh = high.includes(taskName);

            if (!existsInLow && !existsInMedium && !existsInHigh) {
                alert("Task not found!");
                return;
            }

            low = low.filter(task => task !== taskName);
            medium = medium.filter(task => task !== taskName);
            high = high.filter(task => task !== taskName);
            recent = recent.filter(task => task.name !== taskName);

            alert(`Task "${taskName}" deleted successfully.`);
            document.getElementById("deleteInput").value = "";
            filterTasks();
        }

        // Render on page load
        window.onload = filterTasks;
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
        crossorigin="anonymous"></script>
</body>

</html>